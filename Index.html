<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>GhostChild Fake Live Trainer</title>
  <style>
    :root{
      --gc-bg:#0b0f10; --gc-card:#0f1517; --gc-accent:#e7c24f; --gc-text:#e6ecef; --gc-muted:#94a3b8;
      --good:#22c55e; --warn:#f59e0b; --bad:#ef4444;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;background:var(--gc-bg);color:var(--gc-text);font:15px/1.45 system-ui,ui-sans-serif,Segoe UI,Roboto}
    button{border:0;border-radius:12px;padding:10px 14px;cursor:pointer;background:#1f2937;color:#fff}
    button.primary{background:var(--gc-accent);color:#111}
    button.ghost{background:#0f172a;border:1px solid #1f2937}
    input,textarea,select{width:100%;background:#0f172a;border:1px solid #1f2937;color:#e5e7eb;border-radius:12px;padding:10px}
    .app{max-width:1100px;margin:0 auto;padding:14px}
    .top{display:flex;align-items:center;justify-content:space-between;margin-bottom:10px}
    .brand{display:flex;align-items:center;gap:10px}
    .live{display:flex;align-items:center;gap:8px;background:#101826;border:1px solid #1f2430;padding:8px 12px;border-radius:999px}
    .dot{width:8px;height:8px;border-radius:999px;background:#fb3f3f;box-shadow:0 0 0 6px rgba(251,63,63,.15);animation:pulse 1.6s infinite}
    @keyframes pulse{0%{box-shadow:0 0 0 0 rgba(251,63,63,.35)}70%{box-shadow:0 0 0 12px rgba(251,63,63,0)}100%{box-shadow:0 0 0 0 rgba(251,63,63,0)}}

    .stage{display:grid;grid-template-columns:1.2fr .8fr;gap:10px}
    @media(max-width:980px){.stage{grid-template-columns:1fr}}

    .videoWrap{position:relative;background:#000;border-radius:16px;overflow:hidden;border:1px solid #1f2430;min-height:420px}
    video{width:100%;height:100%;object-fit:cover}
    .hud{position:absolute;inset:0;pointer-events:none}
    .hud .row{position:absolute;left:10px;top:10px;display:flex;gap:8px;align-items:center}
    .badge{background:rgba(0,0,0,.55);color:#fff;padding:5px 9px;border-radius:999px;font-size:12px;border:1px solid rgba(255,255,255,.12)}
    .badge.gold{background:rgba(231,194,79,.15);border-color:rgba(231,194,79,.35);color:#f9e8a5}
    .likes{position:absolute;right:10px;bottom:10px;display:flex;flex-direction:column;align-items:center;gap:8px}
    .heart{width:20px;height:20px;position:absolute;bottom:10px;right:10px;opacity:.9;animation:float 2.2s ease-out forwards}
    .heart:before{content:"";position:absolute;left:10px;top:0;width:10px;height:16px;background:#ff4470;border-radius:10px 10px 0 0;transform:rotate(-45deg);transform-origin:0 100%}
    .heart:after{content:"";position:absolute;left:0;top:0;width:10px;height:16px;background:#ff4470;border-radius:10px 10px 0 0;transform:rotate(45deg);transform-origin:100% 100%}
    @keyframes float{0%{transform:translateY(0) scale(1);opacity:.95} 85%{opacity:.9} 100%{transform:translateY(-180px) scale(1.3);opacity:0}}

    .chat{background:var(--gc-card);border-radius:16px;border:1px solid #1f2430;display:flex;flex-direction:column;min-height:420px;overflow:hidden}
    .chatHead{display:flex;align-items:center;justify-content:space-between;padding:10px;border-bottom:1px solid #1f2430}
    .chatBody{flex:1;overflow:auto;padding:10px;display:flex;flex-direction:column;gap:8px}
    .msg{display:flex;gap:8px;align-items:flex-start}
    .avatar{width:28px;height:28px;border-radius:999px;background:#0b1220;border:1px solid #1f2430;display:flex;align-items:center;justify-content:center;font-size:12px;color:#bcd}
    .msg .bubble{background:#0b1220;border:1px solid #1f2430;padding:8px 10px;border-radius:12px 12px 12px 6px;max-width:92%}
    .name{color:#c7d2fe;font-weight:600;margin-right:6px}
    .sys{color:var(--gc-muted);font-size:12px;text-align:center}

    .controls{display:flex;flex-wrap:wrap;gap:8px;margin-top:10px}
    .settings{margin-top:10px;background:#0b1220;border:1px solid #1f2430;border-radius:16px;padding:10px}
    .row{display:flex;gap:8px;flex-wrap:wrap}
    .col{flex:1 1 240px}
    .small{font-size:12px;color:var(--gc-muted)}
    .footer{margin-top:10px;color:var(--gc-muted);font-size:12px}
  </style>
</head>
<body>
  <div class="app">
    <div class="top">
      <div class="brand">
        <div style="width:26px;height:26px;border-radius:8px;background:linear-gradient(135deg,#0d1117,#1b2838);display:flex;align-items:center;justify-content:center;border:1px solid #1f2430">üó°Ô∏è</div>
        <div>
          <div style="font-weight:700;letter-spacing:.4px">GhostChild Fake Live Trainer</div>
          <div class="small">Practice your live banter with AI-ish bot chat. No audience, no pressure.</div>
        </div>
      </div>
      <div class="live"><div class="dot"></div><div>LIVE (training)</div></div>
    </div>

    <div class="stage">
      <!-- VIDEO / HUD -->
      <div class="videoWrap" id="videoWrap">
        <video id="cam" playsinline autoplay muted></video>
        <div class="hud">
          <div class="row">
            <div class="badge">@<span id="handle">ghostchild</span></div>
            <div class="badge gold">üëÅÔ∏è <span id="viewers">0</span></div>
            <div class="badge">‚ù§Ô∏è <span id="likes">0</span></div>
            <div class="badge">‚è± <span id="clock">00:00</span></div>
          </div>
        </div>
        <div class="likes" id="likeArea"></div>
      </div>

      <!-- CHAT -->
      <div class="chat">
        <div class="chatHead">
          <div style="font-weight:600">Chat</div>
          <div class="small">Bots on: <span id="botsState">off</span></div>
        </div>
        <div class="chatBody" id="chatBody"></div>
        <div style="padding:10px;border-top:1px solid #1f2430">
          <div class="row">
            <input id="myMsg" placeholder="Type a line and press Enter‚Ä¶ (for practice reactions)" />
            <button class="ghost" id="sendBtn">Send</button>
          </div>
        </div>
      </div>
    </div>

    <!-- CONTROLS -->
    <div class="controls">
      <button class="primary" id="startCam">Start Camera</button>
      <button id="toggleBots">Start Bots</button>
      <button id="hype">Trigger Hype</button>
      <button id="screenshot">Screenshot Frame</button>
      <button id="clearChat" class="ghost">Clear Chat</button>
      <button id="saveLog" class="ghost">Download Chat Log</button>
      <button id="toggleSettings" class="ghost">Settings</button>
    </div>

    <!-- SETTINGS -->
    <div class="settings" id="settings" hidden>
      <div class="row">
        <div class="col">
          <label>Handle</label>
          <input id="setHandle" />
        </div>
        <div class="col">
          <label>Baseline viewers</label>
          <input id="setViewBase" type="number" min="0" />
        </div>
        <div class="col">
          <label>Message rate (ms)</label>
          <input id="setRate" type="number" min="300" />
        </div>
        <div class="col">
          <label>Bot style</label>
          <select id="setStyle">
            <option value="support">Supportive</option>
            <option value="roast">Roast / banter</option>
            <option value="coach">Coach / questions</option>
          </select>
        </div>
      </div>
      <div class="row" style="margin-top:8px">
        <div class="col">
          <label>Custom script lines (one per line)
            <div class="small">Bots will mix these into chat.</div>
          </label>
          <textarea id="setScript" rows="6" placeholder="Drop your quotes, prompts, objections, hype lines here‚Ä¶"></textarea>
        </div>
      </div>
      <div class="row" style="margin-top:8px">
        <button id="saveSettings" class="primary">Save</button>
        <div class="small">Hotkeys: C=Camera, B=Bots, H=Hype, S=Settings</div>
      </div>
    </div>

    <div class="footer">Training tool for practice only. No real viewers, no network usage beyond your camera. All data stays in your browser.</div>
  </div>

  <script>
    // -------------------------
    // Utilities
    // -------------------------
    const $ = sel => document.querySelector(sel)
    const chatBody = $('#chatBody')
    const viewersEl = $('#viewers')
    const likesEl = $('#likes')
    const likeArea = $('#likeArea')
    const botsStateEl = $('#botsState')
    const clockEl = $('#clock')

    const rnd = (a,b)=> Math.floor(Math.random()*(b-a+1))+a
    const choice = arr => arr[Math.floor(Math.random()*arr.length)]

    function save(name, value){ localStorage.setItem(name, JSON.stringify(value)) }
    function load(name, fallback){ try{ return JSON.parse(localStorage.getItem(name)) ?? fallback }catch{ return fallback } }

    function pad2(n){ return String(n).padStart(2,'0') }

    function download(filename, text){
      const blob = new Blob([text], {type:'text/plain'})
      const a = document.createElement('a')
      a.href = URL.createObjectURL(blob)
      a.download = filename
      a.click()
      URL.revokeObjectURL(a.href)
    }

    // -------------------------
    // Camera
    // -------------------------
    const cam = $('#cam')
    async function startCamera(){
      try{
        const stream = await navigator.mediaDevices.getUserMedia({ video:{ facingMode:'user' }, audio:true })
        cam.srcObject = stream
        $('#startCam').textContent = 'Camera On'
        $('#startCam').disabled = true
      }catch(e){ alert('Camera/mic blocked. Allow permissions to practice. '+ e.message) }
    }

    // -------------------------
    // Chat data
    // -------------------------
    const FIRST = ['Kai','Mika','Rae','Luca','Noa','Sage','Aria','Zee','Tane','Mali','Jax','Tori','Koa','Rook','Navi','Kane','Dax','Nova','Sefa','Lani']
    const LAST  = ['Fiji','PNG','Sam','Ghost','Vault','Empire','Alpha','Beta','Sigma','Edge','Volt','Storm','Reign','Wave','Raptor']
    function botName(){ return choice(FIRST) + ' ' + choice(LAST) }

    const SUPPORT = [
      'This is the vibe. üî•',
      'Talk your truth, bro.',
      'Mic sounds clean.',
      'Drop a system for that.',
      'Lesson landed. Say it again.',
      'W stream energy.',
      'Clipping this in my head üòÇ',
      'Ghost Child mode unlocked.',
      'Respect from the islands. üåä',
    ]
    const ROAST = [
      'Mid take, cook harder. üòà',
      'You dodged the point‚Äîrun it back.',
      'Too safe. Give me blood.',
      'Chat wants proof, not poetry.',
      'Talk is cheap. Show the kill.',
      'Where‚Äôs the system, commander?',
      'Bro, you just invented water. Again.',
    ]
    const COACH = [
      'Define the problem in one line.',
      'What‚Äôs the first step right now?',
      'Give the 3 rules. Short.',
      'Who‚Äôs this for? Name him.',
      'What‚Äôs the proof? Numbers.',
      'Where does this break?',
      'Repeat the formula.',
    ]

    // -------------------------
    // State
    // -------------------------
    const state = {
      handle: load('gc_handle','ghostchild'),
      viewersBase: load('gc_viewbase', 37),
      msgRate: load('gc_msgrate', 1200),
      style: load('gc_style','support'),
      script: load('gc_script','').split('\n').filter(Boolean),
      botsOn: false,
      likes: 0,
      viewers: 0,
      clockStart: 0,
      log: [],
    }

    // init UI from state
    $('#handle').textContent = state.handle
    $('#setHandle').value = state.handle
    $('#setViewBase').value = state.viewersBase
    $('#setRate').value = state.msgRate
    $('#setStyle').value = state.style
    $('#setScript').value = state.script.join('\n')

    // -------------------------
    // Viewer + likes engine
    // -------------------------
    function tickViewers(){
      const drift = rnd(-2,4)
      if(state.viewers<=0) state.viewers = state.viewersBase + rnd(-3,6)
      state.viewers = Math.max(0, state.viewers + drift)
      viewersEl.textContent = state.viewers
      if(Math.random()<0.4){ addHeart() }
    }

    function addHeart(){
      state.likes++
      likesEl.textContent = state.likes
      const h = document.createElement('div')
      h.className = 'heart'
      const dx = rnd(-20, 20)
      h.style.right = (10 + dx) + 'px'
      likeArea.appendChild(h)
      setTimeout(()=>h.remove(), 2200)
    }

    setInterval(tickViewers, 1200)

    // -------------------------
    // Clock
    // -------------------------
    function startClock(){
      state.clockStart = Date.now()
      setInterval(()=>{
        const s = Math.floor((Date.now()-state.clockStart)/1000)
        clockEl.textContent = `${pad2(Math.floor(s/60))}:${pad2(s%60)}`
      }, 1000)
    }
    startClock()

    // -------------------------
    // Chat rendering
    // -------------------------
    function pushMsg(name, text){
      const row = document.createElement('div')
      row.className = 'msg'
      const av = document.createElement('div')
      av.className = 'avatar'
      av.textContent = initials(name)
      const bubble = document.createElement('div')
      bubble.className = 'bubble'
      bubble.innerHTML = `<span class="name">${escapeHTML(name)}</span>${escapeHTML(text)}`
      row.appendChild(av); row.appendChild(bubble)
      chatBody.appendChild(row)
      chatBody.scrollTop = chatBody.scrollHeight
      state.log.push(`[${new Date().toLocaleTimeString()}] ${name}: ${text}`)
      if(Math.random()<0.5) addHeart()
    }

    function pushSys(text){
      const row = document.createElement('div')
      row.className = 'sys'
      row.textContent = text
      chatBody.appendChild(row)
      chatBody.scrollTop = chatBody.scrollHeight
      state.log.push(`[SYS] ${text}`)
    }

    function initials(n){ return n.split(' ').map(s=>s[0]).slice(0,2).join('').toUpperCase() }
    function escapeHTML(s){ return s.replace(/[&<>"']/g, c=>({"&":"&amp;","<":"&lt;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#39;"}[c])) }

    // -------------------------
    // Bot engine
    // -------------------------
    let botTimer = null

    function botLine(){
      const mode = state.style
      const pool = (
        mode==='support' ? SUPPORT :
        mode==='roast' ? ROAST : COACH
      ).slice()
      // mix custom script sometimes
      if(state.script.length && Math.random()<0.6){ pool.push(choice(state.script)) }
      // make it feel directed
      let line = choice(pool)
      line = line.replace(/(bro|man|dude)/gi,'commander')
      if(Math.random()<0.2) line += ' ‚ö°'
      return line
    }

    function tickBots(){
      if(!state.botsOn) return
      pushMsg(botName(), botLine())
      scheduleBot()
    }

    function scheduleBot(){
      clearTimeout(botTimer)
      botTimer = setTimeout(tickBots, jitter(state.msgRate, 0.45))
    }

    function jitter(ms, spread=0.3){
      const d = ms*spread
      return Math.max(300, ms + rnd(-d, d))
    }

    function startBots(){ state.botsOn=true; botsStateEl.textContent='on'; pushSys('Bots joined the chat.'); scheduleBot() }
    function stopBots(){ state.botsOn=false; botsStateEl.textContent='off'; pushSys('Bots paused.') ; clearTimeout(botTimer) }

    function hype(){
      for(let i=0;i<10;i++) setTimeout(addHeart, i*120)
      state.viewers += rnd(12,30)
      viewersEl.textContent = state.viewers
      const bursts = [
        'CHAT MOVING. Keep going. üó°Ô∏è',
        'Numbers spiking. Press the attack.',
        'Clippers awake. Give them a line.',
        'Momentum detected. Dominate now.',
      ]
      pushSys(choice(bursts))
      for(let j=0;j<rnd(3,6);j++) pushMsg(botName(), botLine())
    }

    // -------------------------
    // Settings
    // -------------------------
    const settings = $('#settings')
    $('#toggleSettings').onclick = ()=> settings.hidden = !settings.hidden
    $('#saveSettings').onclick = ()=>{
      state.handle = $('#setHandle').value.trim()||'ghostchild'
      $('#handle').textContent = state.handle
      state.viewersBase = Math.max(0, parseInt($('#setViewBase').value||'0',10))
      state.msgRate = Math.max(300, parseInt($('#setRate').value||'1200',10))
      state.style = $('#setStyle').value
      state.script = $('#setScript').value.split('\n').map(s=>s.trim()).filter(Boolean)
      save('gc_handle', state.handle)
      save('gc_viewbase', state.viewersBase)
      save('gc_msgrate', state.msgRate)
      save('gc_style', state.style)
      save('gc_script', state.script.join('\n'))
      settings.hidden = true
      pushSys('Settings saved.')
    }

    // -------------------------
    // Buttons & inputs
    // -------------------------
    $('#startCam').onclick = startCamera
    $('#toggleBots').onclick = ()=> state.botsOn ? stopBots() : startBots()
    $('#hype').onclick = hype
    $('#clearChat').onclick = ()=>{ chatBody.innerHTML=''; state.log.length=0 }
    $('#saveLog').onclick = ()=> download('ghostchild-chat-log.txt', state.log.join('\n'))
    $('#screenshot').onclick = ()=> screenshotFrame()

    $('#sendBtn').onclick = sendMyMsg
    $('#myMsg').addEventListener('keydown', (e)=>{ if(e.key==='Enter'){ e.preventDefault(); sendMyMsg() } })
    function sendMyMsg(){
      const v = $('#myMsg').value.trim()
      if(!v) return
      pushMsg(state.handle, v)
      $('#myMsg').value = ''
    }

    // Hotkeys
    document.addEventListener('keydown', (e)=>{
      if(['INPUT','TEXTAREA'].includes(document.activeElement.tagName)) return
      const k = e.key.toLowerCase()
      if(k==='c') startCamera()
      if(k==='b') state.botsOn ? stopBots() : startBots()
      if(k==='h') hype()
      if(k==='s') settings.hidden = !settings.hidden
    })

    // -------------------------
    // Screenshot (without external libs)
    // We draw the current video frame into a canvas, then stamp HUD numbers.
    // Chat overlay isn't captured (browser limitation) ‚Äî this is for thumbnails.
    // -------------------------
    function screenshotFrame(){
      const v = cam
      if(!v.videoWidth){ alert('Camera not ready.'); return }
      const c = document.createElement('canvas')
      c.width = v.videoWidth; c.height = v.videoHeight
      const ctx = c.getContext('2d')
      ctx.drawImage(v, 0, 0, c.width, c.height)
      // simple HUD text
      ctx.fillStyle = 'rgba(0,0,0,.45)'; ctx.fillRect(16,16,260,60)
      ctx.fillStyle = '#f2f5f7'; ctx.font = '22px system-ui'; ctx.fillText('@'+state.handle, 28, 44)
      ctx.fillStyle = '#f7e39a'; ctx.font = '18px system-ui';
      ctx.fillText('üëÅ '+state.viewers+'   ‚ù§Ô∏è '+state.likes+'   ‚è± '+clockEl.textContent, 28, 70)
      c.toBlob(b=>{
        const url = URL.createObjectURL(b)
        const a = document.createElement('a')
        a.href = url; a.download = 'ghostchild_frame.png'; a.click(); URL.revokeObjectURL(url)
      })
    }

    // greet
    pushSys('Welcome, commander. Press C to start camera, B to start bots, H to spike hype.')
  </script>
</body>
</html>
